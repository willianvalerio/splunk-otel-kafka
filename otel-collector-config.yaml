exporters:
  sapm:
    access_token: ${SPLUNK_ACCESS_TOKEN}
    endpoint: https://ingest.${SPLUNK_REALM}.signalfx.com/v2/trace
  signalfx:
    access_token: ${SPLUNK_ACCESS_TOKEN}
    api_url: https://api.${SPLUNK_REALM}.signalfx.com
    ingest_url: https://ingest.${SPLUNK_REALM}.signalfx.com
    realm: ${SPLUNK_REALM}
    sync_host_metadata: true
    correlation: null
extensions:
  health_check: null
  http_forwarder:
    egress:
      endpoint: 'https://api.${SPLUNK_REALM}.signalfx.com'
  zpages:
    endpoint: 0.0.0.0:55679
receivers:
  hostmetrics:
    collection_interval: 10s
    scrapers:
      cpu: null
      disk: null
      filesystem: null
      memory: null
      network: null
      load: null
      paging: null
      processes: null
  jaeger:
    protocols:
      grpc: null
      thrift_binary: null
      thrift_compact: null
      thrift_http: null
  otlp:
    protocols:
      grpc: null
      http: null
  sapm: null
  signalfx: null
  prometheus:
    config:
      scrape_configs:
        - job_name: otel-collector
          scrape_interval: 10s
          static_configs:
            - targets:
                - 'localhost:8888'
              # labels:
              #   environment: demo
          metric_relabel_configs:
            - source_labels:
                - __name__
              regex: .*grpc_io.*
              action: drop
  zipkin: null
  smartagent/docker:
    type: docker-container-stats
  smartagent/zookeeper:
    type: collectd/zookeeper
    host: zookeeper
    port: 2181
  smartagent/kafka:
    type: collectd/kafka
    host: kafka
    port: 9989
    clusterName: wvalerio-kafka
    mBeansToOmit:
    - "kafka.log.flush"
processors:
  batch: null
  memory_limiter:
    ballast_size_mib: 168
    check_interval: 2s
    limit_mib: 460
  resourcedetection:
    detectors:
      - system
    override: false
  resource/add_environment:
    attributes:
    - action: insert
      key: deployment.environment
      value: ${SFX_ENVIRONMENT}
service:
  extensions:
    - health_check
    - http_forwarder
    - zpages
  pipelines:
    traces:
      receivers:
        - jaeger
        - otlp
        - sapm
        - zipkin
      processors:
        - memory_limiter
        - resourcedetection
        - batch
        - resource/add_environment
      exporters:
        - sapm
        - signalfx
    metrics:
      receivers:
        - otlp
        - signalfx
        - prometheus
        - hostmetrics
        - smartagent/docker
        - smartagent/zookeeper
      processors:
        - memory_limiter
        - batch
        - resourcedetection
        - resource/add_environment
      exporters:
        - signalfx
    logs:
      receivers:
        - signalfx
      processors:
        - memory_limiter
        - batch
        - resourcedetection
        - resource/add_environment
      exporters:
        - signalfx
